import boto3

sqs = boto3.client('sqs',region_name='us-east-1')
req_queue_url = 'https://sqs.us-east-1.amazonaws.com/749917607921/RequestQueue'
res_queue_url = 'https://sqs.us-east-1.amazonaws.com/749917607921/ResponseQueue'

response = sqs.receive_message(
    QueueUrl=req_queue_url,
    AttributeNames=[
        'filename'
    ],
    MaxNumberOfMessages=1,
    MessageAttributeNames=[
        'All'
    ],
    VisibilityTimeout=0,
    WaitTimeSeconds=0
)
message = response['Messages'][0]
if(len(message) == 0) :
    print('empty queue')
receipt_handle = message['ReceiptHandle']
message_body = message['Body']
filename = message['MessageAttributes']['filename']['StringValue']
fh = open(filename, "wb")
fh.write(message_body)
fh.close()
print(message_body)

